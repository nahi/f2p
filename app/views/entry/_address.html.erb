<p>
  Address: <%= text_field_tag('title', @title) %> <%= submit_tag 'search' %><br />
  geocoding language: '<%= h(setting.google_maps_geocoding_lang || 'ja') %>'<br />
  <%- if gps_link = gps_link(:action => 'new') -%>
    get GPS data: <%= gps_link %>
  <%- else -%>
    <script type='text/javascript'><!--
      function getCurrentPosition() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(postPosition);
        } else {
          alert('Geolocation API is not supported.');
        }
      }
      function postPosition(pos) {
        var url = "./new?lat=" + pos.coords.latitude + "&long=" + pos.coords.longitude;
        location.replace(url);
      }
    //--></script>
    get GPS data: <a href="#" onclick="getCurrentPosition()">Geolocation API</a>
  <%- end -%>
  <%= hidden_field_tag('lat', @lat) %>
  <%= hidden_field_tag('long', @long) %>
  <%= hidden_field_tag('address', @address) %>
</p>
<%- if @placemark -%>
  <%- if @placemark.ambiguous? -%>
    <p>Ambiguous:</p>
    <ul>
      <%- @placemark.candidates.each do |cand| -%>
        <li><%= h(cand) %></li>
      <%- end -%>
    </ul>
  <%- else -%>
    <dl>
      <dt>Preview: <%= h(@placemark.address) %></dt>
      <dd><%= google_maps_link(@placemark, nil) %></dd>
    </dl>
  <%- end -%>
<%- end -%>
